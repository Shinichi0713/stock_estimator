# 目的
TransFormerはトークンの関係性からコンテキストを読み解くことにたけているため、時系列予測にも使える可能性が考えられる。
他方、時系列予測に重要な特徴的な情報への変換を行わない時系列データを与えた場合精度がよくなるかに少し疑問を感じる。
上記可能性と疑問を確認するため、TransFormerを用いて株価時系列予測を行う。

# モデル構成
ベースモデルはtorchに実装されているTransformerをそのまま用いる
ポジショナルエンコーダ：時系列に強い相対エンコーディングを採用
エンコーダ：nn.TransformerEncoderLayerブロックをマルチヘッドとして構築
デコーダ：nn.Linearにより値を推論する

# データ
yahooファイナンスにより取得可能な銘柄の時系列データを用いる

# 学習法
1.yahooファイナンスにより取得可能な銘柄の時系列データを、指定のウィンドウサイズで分割
2.1のデータをバッチ化する
3.2のデータを、作成したAIモデルに適用し学習する

# 精度の確認
ホンダ社の株価を用いた推論と実際のデータは以下通りとなった。
![image](https://github.com/Shinichi0713/stock_estimator/assets/61480734/dc1a3746-674d-4879-a275-830425acdd4f)

## 所感
1.推論は、大まかなトレンドはあっているようにみえるが、実際に起こっている変動を予測はできていない
  - 入力情報は株価の数値データで与えていたが、株価に影響を与えるようなそのほかの要因を踏まえたベクトル情報ではなかったため、十分な推論が出来なかったかもしれない→入力する時系列データに工夫が必要＋コンテキスト情報も併せてみる必要の可能性あり
  - エンコーダの積層が少なかったため、十分な解釈が出来なかった可能性がある
## 今後に向けて
1.モデルの積層数や、エンコーダの組み方について、より時系列予測に適した方法を調査する
2.時系列にプラスアルファできる情報があれば活用する
